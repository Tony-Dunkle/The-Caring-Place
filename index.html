<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Caring Place Bingo</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c; /* Deep charcoal background */
            color: #e2e8f0; /* Light gray text for contrast */
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 2rem;
            position: relative;
        }
        .container {
            background-color: #2d3748; /* Darker gray background for the main container */
            border-radius: 1.5rem;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4); /* Deeper shadow */
            padding: 2.5rem;
            max-width: 900px;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
        }
        /* Header specific styles for the new layout */
        .app-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            margin-bottom: 1rem; /* Adjusted margin to bring closer to number display */
        }
        .header-title-left {
            color: #c084fc; /* Tailwind Purple-400 for header text */
            font-size: 3rem; /* Smaller font size for "The Caring Place" */
            font-weight: bold;
            text-shadow: 0 0 10px rgba(192, 132, 252, 0.4); /* Subtle glow */
            flex-shrink: 1; /* Allow shrinking if space is tight */
            text-align: left; /* Align to left */
        }
        .header-bingo-center {
            color: #c084fc;
            font-size: 4rem; /* Prominent "Bingo" text */
            font-weight: bold;
            text-shadow: 0 0 15px rgba(192, 132, 252, 0.5);
            flex-grow: 1; /* Allow it to take available space */
            text-align: center; /* Center align */
            white-space: nowrap; /* Prevent "Bingo" from wrapping */
            min-width: fit-content; /* Ensure it doesn't get too small */
            padding: 0 1rem; /* Add some padding around "Bingo" */
        }
        .header-image-container {
            width: 300px; /* Desired smaller image width */
            height: 133px; /* Desired smaller image height (maintaining aspect ratio) */
            border-radius: 0.75rem;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.2);
            flex-shrink: 0; /* Prevent shrinking */
            overflow: hidden; /* Ensure image doesn't spill out if larger */
        }
        .header-image-container img {
            width: 100%;
            height: 100%;
            object-fit: contain; /* Contain the image within the dimensions */
            background-color: #4a5568; /* Placeholder background if image fails to load */
        }
        @media (max-width: 900px) { /* Adjust for smaller screens where the image might be too big */
            .header-image-container {
                width: 100%; /* Make it fluid on smaller screens */
                height: 100px; /* Adjust height for fluid width */
            }
            .app-header {
                flex-wrap: wrap; /* Allow wrapping on smaller screens */
                justify-content: center;
                gap: 1rem; /* Space between wrapped items */
            }
            .header-title-left,
            .header-bingo-center {
                flex-basis: 100%; /* Take full width when wrapped */
                text-align: center; /* Center align all elements when wrapped */
            }
            .header-title-left {
                font-size: 2.5rem;
            }
            .header-bingo-center {
                font-size: 3.5rem;
            }
        }

        .number-display {
            background-color: #7c3aed; /* Tailwind Purple-600 for current number */
            color: #ffffff;
            font-size: 8rem;
            font-weight: bold;
            padding: 2rem 3rem;
            border-radius: 1rem;
            min-width: 250px;
            text-align: center;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
            transition: transform 0.1s ease-out;
            display: flex;
            justify-content: center;
            align-items: center;
            line-height: 1;
            margin-top: 0; /* Remove top margin as it's now directly below header */
            margin-bottom: 2rem; /* Add margin below to separate from next section */
        }
        .number-display.pop {
            transform: scale(1.1);
        }
        .control-button {
            background-color: #9333ea; /* Tailwind Purple-700 */
            color: white;
            padding: 1.2rem 2.5rem;
            font-size: 1.8rem;
            font-weight: bold;
            border-radius: 0.75rem;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        .control-button:hover {
            background-color: #7e22ce; /* Darker purple on hover */
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
        }
        .control-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        .reset-button {
            background-color: #dc2626; /* Tailwind Red-600 for reset button */
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 100;
        }
        .reset-button:hover {
            background-color: #b91c1c; /* Darker red on hover */
        }
        .called-numbers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
            gap: 0.75rem;
            max-height: 450px; /* Increased height */
            overflow-y: auto;
            padding: 1rem;
            background-color: #4a5568; /* Dark gray for the grid background */
            border-radius: 0.75rem;
            border: 1px solid #4a5568; /* Darker border */
        }
        .called-number-item {
            background-color: #6b46c1; /* Tailwind Purple-700 for individual numbers */
            color: #e2e8f0; /* Light text on dark background */
            font-size: 1.6rem;
            font-weight: bold;
            padding: 0.75rem;
            border-radius: 0.5rem;
            text-align: center;
            box-shadow: 0 3px 7px rgba(0, 0, 0, 0.2);
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .error-message { /* Keeping this just in case for future use, though not used currently */
            color: #f87171; /* Tailwind Red-400 for error messages */
            font-size: 1.1rem;
            margin-top: 0.5rem;
            text-align: center;
            min-height: 24px;
        }
        .rules-section {
            background-color: #4a5568; /* Darker background for rules */
            border: 1px solid #718096; /* Darker border */
            border-radius: 1rem;
            padding: 2rem;
            font-size: 1.2rem;
            line-height: 1.6;
            color: #e2e8f0; /* Light text for rules */
        }
        .rules-section h3 {
            font-size: 2rem;
            font-weight: bold;
            color: #c084fc; /* Purple heading for rules */
            margin-bottom: 1rem;
            text-align: center;
        }
        .rules-section ul {
            list-style: disc;
            padding-left: 1.5rem;
        }
        .rules-section li {
            margin-bottom: 0.5rem;
        }

        /* Modal specific styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7); /* Dark semi-transparent background */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000; /* Above all other content */
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background-color: #4a5568; /* Changed to match all-number-item background */
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5); /* Stronger shadow */
            max-width: 90%;
            max-height: 90vh; /* Max height to prevent overflow on smaller screens */
            overflow-y: auto; /* Enable scrolling for modal content */
            position: relative;
            color: #e2e8f0; /* Light text for modal */
            border: 1px solid #6b46c1; /* Added a subtle purple border */
        }
        .modal-close-button {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 2rem;
            color: #a0aec0; /* Gray for close button */
            cursor: pointer;
            transition: color 0.2s ease;
        }
        .modal-close-button:hover {
            color: #cbd5e0; /* Lighter gray on hover */
        }
        /* All numbers grid and column layout */
        .all-numbers-grid-container {
            display: flex;
            flex-direction: row; /* Layout columns horizontally */
            justify-content: center;
            gap: 1rem; /* Space between columns */
            flex-wrap: wrap; /* Allow columns to wrap on smaller screens */
        }
        .bingo-column {
            display: flex;
            flex-direction: column; /* Stack numbers vertically within a column */
            gap: 0.25rem; /* Small gap between numbers in a column */
            min-width: 75px; /* Minimum width for each column */
            border: 1px solid #4a5568; /* Subtle border for columns */
            border-radius: 0.5rem;
            padding: 0.5rem;
            align-items: center; /* Center numbers within column */
            flex-grow: 1; /* Allow columns to grow */
            flex-basis: auto; /* Allow content to determine basis */
        }
        .bingo-column-header {
            font-size: 1.8rem; /* Larger header for B, I, N, G, O */
            font-weight: bold;
            color: #c084fc; /* Purple for column headers */
            margin-bottom: 0.5rem;
            text-shadow: 0 0 8px rgba(192, 132, 252, 0.3);
        }
        .all-number-item {
            background-color: #4a5568; /* Darker background for each number item */
            color: #e2e8f0; /* Light text */
            font-size: 1.2rem;
            font-weight: bold;
            padding: 0.6rem;
            border-radius: 0.3rem;
            text-align: center;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.2);
            transition: background-color 0.2s ease, color 0.2s ease;
            width: 100%; /* Make items take full column width */
            cursor: pointer; /* Indicate clickability */
        }
        .all-number-item:hover:not(.called) {
            background-color: #6b46c1; /* Darker purple on hover for uncalled numbers */
        }
        .all-number-item.called {
            background-color: #9333ea; /* Purple for called numbers */
            color: white;
            box-shadow: 0 0 5px rgba(192, 132, 252, 0.7); /* Subtle glow for called numbers */
            cursor: not-allowed; /* Indicate not clickable */
            opacity: 0.6; /* Slightly fade called numbers */
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            body {
                padding: 1rem;
            }
            .container {
                padding: 1.5rem;
                gap: 1.5rem;
            }
            .app-header {
                flex-direction: column; /* Stack header elements on small screens */
                align-items: center;
                gap: 1.5rem;
                margin-bottom: 1.5rem;
            }
            .header-title-left {
                font-size: 2.2rem;
                text-align: center;
            }
            .header-bingo-center {
                font-size: 3rem;
                padding: 0;
            }
            .header-image-container {
                width: 100%;
                height: 80px; /* Adjusted height for smaller fluid width */
            }
            .header-image-container img {
                font-size: 0.8rem; /* Make alt text smaller on mobile */
            }
            .number-display {
                font-size: 4rem;
                padding: 1rem 1.5rem;
                min-width: unset;
                width: 100%;
                margin-bottom: 1.5rem; /* Adjusted margin for mobile */
            }
            .control-button {
                font-size: 1.4rem;
                padding: 0.8rem 1.8rem;
            }
            .called-numbers-grid {
                grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));
                font-size: 1.2rem;
                max-height: 350px;
            }
            .called-number-item {
                font-size: 1.2rem;
            }
            .rules-section {
                font-size: 1rem;
                padding: 1.5rem;
            }
            .rules-section h3 {
                font-size: 1.75rem;
            }
            .reset-button {
                bottom: 1rem;
                right: 1rem;
                padding: 0.8rem 1.5rem;
                font-size: 1.4rem;
            }
            .modal-content {
                padding: 1rem;
            }
            .modal-close-button {
                font-size: 1.5rem;
                top: 0.5rem;
                right: 0.5rem;
            }
            .all-numbers-grid-container {
                flex-direction: column;
                align-items: center;
            }
            .bingo-column {
                width: 80%;
                max-width: 150px;
                flex-basis: auto;
            }
            .bingo-column-header {
                font-size: 1.5rem;
            }
            .all-number-item {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header Section -->
        <div class="app-header">
            <h1 class="header-title-left">The Caring Place</h1>
            <h1 class="header-bingo-center">Bingo</h1>
            <div class="header-image-container">
                <img src="Caring Place Logo.png" alt="The Caring Place Logo" onerror="this.onerror=null;this.src='https://placehold.co/300x133/4a5568/a0aec0?text=Logo+Unavailable';">
            </div>
        </div>

        <!-- Current Number Display (Moved Here to the Left) -->
        <div class="w-full flex justify-start">
            <div id="currentNumberDisplay" class="number-display">
                --
            </div>
        </div>

        <!-- Game Type Selection Section -->
        <div class="game-type-section w-full mb-4 text-center">
            <label for="gameTypeSelect" class="text-xl font-bold text-gray-200 block mb-2">Select Game Type:</label>
            <select id="gameTypeSelect" class="bg-gray-700 text-purple-300 border border-purple-500 rounded-md p-2 text-lg focus:outline-none focus:ring-2 focus:ring-purple-400">
                <option value="standard">Standard Bingo (5 in a row)</option>
                <option value="four-corners">Four Corners</option>
                <option value="blackout">Blackout / Coverall</option>
                <option value="custom">Custom Pattern (Explain to players)</option>
            </select>
            <p class="text-2xl font-bold text-purple-300 mt-4">Current Game: <span id="currentGameTypeDisplay">Standard Bingo (5 in a row)</span></p>
        </div>

        <!-- Called Numbers Section -->
        <div class="w-full">
            <h2 class="text-3xl font-bold text-gray-200 mb-4 text-center">Called Numbers</h2>
            <div id="calledNumbersGrid" class="called-numbers-grid">
                <!-- Numbers will be dynamically added here -->
                <p id="noNumbersYet" class="text-gray-400 text-center col-span-full text-lg">No numbers called yet.</p>
            </div>
        </div>

        <!-- Controls -->
        <div class="flex flex-col items-center w-full gap-4 mt-4">
            <button id="showAllNumbersBtn" class="control-button">Show All Callable Numbers</button>
        </div>

        <!-- Bingo Rules Section -->
        <div class="rules-section w-full mt-8">
            <h3>Bingo Rules</h3>
            <ul>
                <li>Standard Bingo: The first player to get 5 numbers in a row, either horizontally, vertically, or diagonally, wins!</li>
                <li>Four Corners: Cover the numbers in all four corner squares of your card.</li>
                <li>Blackout/Coverall: Cover every single number on your bingo card. This is usually the last game!</li>
                <li>Pattern Games: Some games might require specific patterns (e.g., a "T" shape, a "postage stamp"). Listen carefully for the pattern!</li>
                <li>Calling Bingo: When you get a winning pattern, shout "BINGO!" loudly and clearly so the caller can hear you.</li>
                <li>Verification: The caller will verify your card against the called numbers. If it's correct, you win!</li>
                <li>Enjoy the Game: Most importantly, have fun and enjoy playing with your friends!</li>
            </ul>
        </div>
    </div>

    <!-- Reset Game Button -->
    <button id="resetGameBtn" class="control-button reset-button">Reset Game</button>

    <!-- Modal for All Callable Numbers -->
    <div id="allNumbersModal" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close-button" id="closeModalBtn">&times;</button>
            <h2 class="text-3xl font-bold text-center text-purple-400 mb-4">All Possible Bingo Numbers</h2>
            <div id="allNumbersGridContainer" class="all-numbers-grid-container">
                <!-- Columns for B, I, N, G, O will be dynamically generated here -->
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const currentNumberDisplay = document.getElementById('currentNumberDisplay');
        const resetGameBtn = document.getElementById('resetGameBtn');
        const calledNumbersGrid = document.getElementById('calledNumbersGrid');
        const noNumbersYetMsg = document.getElementById('noNumbersYet');
        const showAllNumbersBtn = document.getElementById('showAllNumbersBtn');
        const allNumbersModal = document.getElementById('allNumbersModal');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const allNumbersGridContainer = document.getElementById('allNumbersGridContainer');
        const gameTypeSelect = document.getElementById('gameTypeSelect');
        const currentGameTypeDisplay = document.getElementById('currentGameTypeDisplay');

        // Game State Variables
        let calledCombinations = new Set();
        let calledNumbersDisplay = [];

        // Bingo Number Ranges for Validation
        const bingoRanges = {
            'B': { min: 1, max: 15 },
            'I': { min: 16, max: 30 },
            'N': { min: 31, max: 45 },
            'G': { min: 46, max: 60 },
            'O': { min: 61, max: 75 }
        };
        const bingoLetters = ['B', 'I', 'N', 'G', 'O'];

        /**
         * Initializes or resets the game state.
         * Clears all called numbers and resets displays.
         */
        function initializeGame() {
            calledCombinations.clear();
            calledNumbersDisplay = [];
            currentNumberDisplay.textContent = '--';
            updateCalledNumbersDisplay();
            updateAllCallableNumbersDisplay();
            if (noNumbersYetMsg) {
                noNumbersYetMsg.style.display = 'block';
            }
            // Reset game type display to default
            gameTypeSelect.value = 'standard';
            updateGameTypeDisplay();
            console.log('Game initialized.');
        }

        /**
         * Adds a number to the called list and updates the UI.
         * This function is now called when a number in the modal is clicked.
         * @param {string} combination - The bingo combination (e.g., "B-7").
         */
        function callNumberFromModal(combination) {
            if (calledCombinations.has(combination)) {
                console.log(`${combination} has already been called.`);
                return;
            }

            calledCombinations.add(combination);
            calledNumbersDisplay.push(combination);
            calledNumbersDisplay.sort((a, b) => {
                const letterOrder = bingoLetters.indexOf(a.charAt(0)) - bingoLetters.indexOf(b.charAt(0));
                if (letterOrder !== 0) return letterOrder;
                const numA = parseInt(a.substring(a.indexOf('-') + 1), 10);
                const numB = parseInt(b.substring(b.indexOf('-') + 1), 10);
                return numA - numB;
            });

            currentNumberDisplay.textContent = combination;
            currentNumberDisplay.classList.remove('pop');
            void currentNumberDisplay.offsetWidth; // Trigger reflow
            currentNumberDisplay.classList.add('pop');

            updateCalledNumbersDisplay();
            updateAllCallableNumbersDisplay();

            console.log(`Called: ${combination}. Total unique called: ${calledCombinations.size}`);
        }

        /**
         * Updates the display of all previously called numbers in the main grid.
         * Handles showing/hiding the "No numbers yet" message.
         */
        function updateCalledNumbersDisplay() {
            calledNumbersGrid.innerHTML = '';

            if (calledNumbersDisplay.length === 0) {
                if (noNumbersYetMsg) {
                    noNumbersYetMsg.style.display = 'block';
                }
            } else {
                if (noNumbersYetMsg) {
                    noNumbersYetMsg.style.display = 'none';
                }
                calledNumbersDisplay.forEach(combination => {
                    const numberDiv = document.createElement('div');
                    numberDiv.classList.add('called-number-item');
                    numberDiv.textContent = combination;
                    calledNumbersGrid.appendChild(numberDiv);
                });
                calledNumbersGrid.scrollTop = calledNumbersGrid.scrollHeight;
            }
        }

        /**
         * Updates the display of all 75 callable bingo numbers in the modal, organized by letter.
         * Marks numbers that have already been called.
         */
        function updateAllCallableNumbersDisplay() {
            allNumbersGridContainer.innerHTML = '';

            bingoLetters.forEach(letter => {
                const columnDiv = document.createElement('div');
                columnDiv.classList.add('bingo-column');

                const columnHeader = document.createElement('div');
                columnHeader.classList.add('bingo-column-header');
                columnHeader.textContent = letter;
                columnDiv.appendChild(columnHeader);

                const range = bingoRanges[letter];
                for (let i = range.min; i <= range.max; i++) {
                    const combination = `${letter}-${i}`;
                    const numberDiv = document.createElement('div');
                    numberDiv.classList.add('all-number-item');
                    numberDiv.textContent = combination;
                    numberDiv.dataset.combination = combination;

                    if (calledCombinations.has(combination)) {
                        numberDiv.classList.add('called');
                    } else {
                        numberDiv.addEventListener('click', () => callNumberFromModal(combination));
                    }
                    columnDiv.appendChild(numberDiv);
                }
                allNumbersGridContainer.appendChild(columnDiv);
            });
        }

        /**
         * Updates the displayed text for the current game type.
         */
        function updateGameTypeDisplay() {
            currentGameTypeDisplay.textContent = gameTypeSelect.options[gameTypeSelect.selectedIndex].text;
        }

        // Event Listeners
        // Game Type Select Listener
        gameTypeSelect.addEventListener('change', updateGameTypeDisplay);

        // Modal Event Listeners
        showAllNumbersBtn.addEventListener('click', () => {
            updateAllCallableNumbersDisplay();
            allNumbersModal.classList.add('show');
        });

        closeModalBtn.addEventListener('click', () => {
            allNumbersModal.classList.remove('show');
        });

        allNumbersModal.addEventListener('click', (event) => {
            if (event.target === allNumbersModal) {
                allNumbersModal.classList.remove('show');
            }
        });

        // Event listener for the Reset Game button
        resetGameBtn.addEventListener('click', initializeGame);

        // Initialize the game when the entire page content has loaded
        document.addEventListener('DOMContentLoaded', initializeGame);
    </script>
</body>
</html>
